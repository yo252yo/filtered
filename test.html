<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        .rectangle {
            width: 200px;
            height: 50px;
            display: flex;
            border: 2px solid black;
            position: relative;
        }

        .cursor {
            position: absolute;
            bottom: 0;
            top: 0;
            width: 2px;
            height: 70px;
            margin-top: -10px;
            background-color: black;
        }
    </style>
</head>

<body>
    <div id="coinFlipContainer"></div>

    <script>
        function drawRectangle(p) {
            const container = document.getElementById('coinFlipContainer');
            container.innerHTML = "";

            const rectangle = document.createElement('div');
            rectangle.classList.add('rectangle');

            const greenPart = document.createElement('div');
            greenPart.style.backgroundColor = "green";
            greenPart.style.width = `${p * 100}%`;

            const redPart = document.createElement('div');
            redPart.style.backgroundColor = "red";
            redPart.style.width = `${(1 - p) * 100}%`;

            const cursor = document.createElement('div');
            cursor.id = "cursor";
            cursor.classList.add('cursor');

            rectangle.appendChild(greenPart);
            rectangle.appendChild(redPart);
            rectangle.appendChild(cursor);
            container.appendChild(rectangle);
        }

        function animate(p) {
            const animationDuration = 2000;
            const rectangleWidth = 200;
            const interval = 10;
            const cursor = document.getElementById("cursor");

            let position = Math.floor(Math.random() * rectangleWidth);
            let step = 1 + Math.floor(Math.random() * 4);
            if (Math.random() < 0.5) {
                step *= -1;
            }


            const intervalId = setInterval(() => {
                position += step;

                if (position > rectangleWidth) {
                    step *= -1;
                    position = rectangleWidth;
                } else if (position < 0) {
                    step *= -1;
                    position = 0;
                }

                cursor.style.left = `${position}px`;
            }, interval);


            var animationDelay = 2000 + Math.floor(Math.random() * 2000);
            setTimeout(() => { step /= 2; }, animationDelay - 1000);
            setTimeout(() => { step /= 2; }, animationDelay - 500);
            setTimeout(() => {
                clearInterval(intervalId); // Stop the interval
                let r = position / rectangleWidth;
                if (r <= p) {
                    console.log(`GREEN`);
                } else {
                    console.log(`RED`);
                }
            }, animationDelay);
        }

        // Example usage: Draw a rectangle with 30% green and 70% red
        drawRectangle(0.3);
        animate(0.3);
    </script>
</body>

</html>